{"ast":null,"code":"var _dec,\n    _class,\n    _temp,\n    _jsxFileName = \"C:\\\\Users\\\\carli\\\\OneDrive\\\\Escritorio\\\\Dev\\\\astrid\\\\InteriorDesing\\\\src\\\\Components\\\\AppContenido.jsx\";\n\nimport \"../App.css\";\nimport React, { Component } from \"react\";\nimport $ from \"jquery\";\nimport axios from \"axios\";\nimport { BP3D } from \"../engine/blueprint3d.js\";\nimport { INIT_STRUCTURE, NEW_STRUCTURE } from \"../Structures.js\";\nimport { BASE_URL, ASSETS } from \"../Constants.js\";\nimport TopBarButton from \"./TopBar/TopBarButton.jsx\";\nimport Button from \"react-bootstrap/Button\";\nimport { FaSearchMinus, FaSearchPlus, FaHome, FaArrowUp, FaArrowDown, FaArrowLeft, FaArrowRight, FaChevronRight, FaArrowsAlt, FaPencilAlt, FaTrashAlt, FaPencilRuler, FaDraftingCompass, FaPlus, FaRedo, FaCamera, FaPenFancy, FaCube, FaInfoCircle } from \"react-icons/fa\";\nimport { Tabs, Tab, OverlayTrigger, Tooltip } from \"react-bootstrap\";\nimport CardListSofa from \"./AddItems/CardListSofa.jsx\";\nimport CardListChair from \"./AddItems/CardListChair.jsx\";\nimport CardListRug from \"./AddItems/CardListRug.jsx\";\nimport CardListMisc from \"./AddItems/CardListMisc.jsx\";\nimport CardListKitchen from \"./AddItems/CardListKitchen.jsx\";\nimport CardListArch from \"./AddItems/CardListArch.jsx\";\nimport CardListLight from \"./AddItems/CardListLight.jsx\";\nimport FloorTextureList from \"./TextureList/FloorTextureList.jsx\";\nimport WallTextureList from \"./TextureList/WallTextureList.jsx\";\nimport ContextMenu from \"./ContextMenu.jsx\";\nimport SaveButton from \"./SaveLoadModal/SaveFile/SaveButton.jsx\";\nimport LoadButton from \"./SaveLoadModal/LoadFile/LoadButton.jsx\";\nimport SaveModal from \"./SaveLoadModal/SaveFile/SaveModal.jsx\";\nimport LoadModal from \"./SaveLoadModal/LoadFile/LoadModal.jsx\";\nimport { inject, observer } from \"mobx-react\";\nimport ScreenCaptureButton from \"./ScreenCaptureButton\";\nlet AppContenido = (_dec = inject(\"store\"), _dec(_class = observer(_class = (_temp = class AppContenido extends Component {\n  constructor(props) {\n    super(props);\n\n    this.sideMenu = function (blueprint3d, floorplanControls, modalEffects) {\n      var modalEffects = modalEffects;\n      var ACTIVE_CLASS = \"active\";\n      var stateChangeCallbacks = $.Callbacks();\n      var tabs = {\n        FLOORPLAN: $(\"#floorplan_tab\"),\n        SHOP: $(\"#items_tab\"),\n        DESIGN: $(\"#design_tab\")\n      };\n      var scope = this;\n      var stateChangeCallbacks = $.Callbacks();\n      var states = {\n        DEFAULT: {\n          div: $(\"#viewer\"),\n          tab: tabs.DESIGN,\n          name: \"Design\"\n        },\n        FLOORPLAN: {\n          div: $(\"#floorplanner\"),\n          tab: tabs.FLOORPLAN,\n          name: \"Floorplan\"\n        },\n        SHOP: {\n          div: $(\"#add-items\"),\n          tab: tabs.SHOP,\n          name: \"Shop\"\n        }\n      };\n      var currentState = states.FLOORPLAN;\n\n      function init() {\n        for (var tab in tabs) {\n          var elem = tabs[tab];\n          elem.click(tabClicked(elem));\n        }\n\n        $(\"#update-floorplan\").click(floorplanUpdate);\n\n        function reset() {\n          $(\"texture-context-container\").hide();\n          $(\"#wallTextures\").hide();\n          $(\"#floorTexturesDiv\").hide();\n        }\n\n        stateChangeCallbacks.add(reset);\n        initLeftMenu();\n        blueprint3d.three.updateWindowSize();\n        handleWindowResize();\n        initItems();\n        setCurrentState(states.DEFAULT, true);\n      }\n\n      function floorplanUpdate() {\n        setCurrentState(states.DEFAULT);\n      }\n\n      function tabClicked(tab) {\n        return function () {\n          initItems();\n          blueprint3d.three.stopSpin();\n\n          for (var key in states) {\n            var state = states[key];\n\n            if (state.tab === tab) {\n              setCurrentState(state);\n              break;\n            }\n          }\n        };\n      }\n\n      var getCurrentState = () => {\n        if (this.state.currentStateName === \"Design\") {\n          return states.DEFAULT;\n        }\n\n        if (this.state.currentStateName === \"Floorplan\") {\n          return states.FLOORPLAN;\n        }\n\n        if (this.state.currentStateName === \"Shop\") {\n          return states.SHOP;\n        }\n\n        return null;\n      };\n\n      var updateState = newState => {\n        this.setState({\n          currentStateName: newState.name\n        });\n      };\n\n      function setCurrentState(newState, firstTime) {\n        currentState = getCurrentState();\n        firstTime = firstTime || false;\n\n        if (!firstTime && currentState.name === newState.name) {\n          return;\n        }\n\n        if (currentState.name !== newState.name) {\n          if (currentState.tab != null) {\n            currentState.tab.removeClass(ACTIVE_CLASS);\n          }\n\n          if (newState.tab != null) {\n            newState.tab.addClass(ACTIVE_CLASS);\n          }\n        }\n\n        if (currentState.name === newState.name) {\n          newState.tab.addClass(ACTIVE_CLASS);\n        }\n\n        if (firstTime || newState.name !== \"Design\") {\n          blueprint3d.three.getController().setSelectedObject(null);\n        }\n\n        currentState.div.hide();\n        newState.div.show();\n\n        if (newState === states.FLOORPLAN) {\n          floorplanControls.handleWindowResize();\n          floorplanControls.updateFloorplanView();\n        }\n\n        if (currentState === states.FLOORPLAN) {\n          blueprint3d.model.floorplan.update();\n        }\n\n        if (newState === states.DEFAULT) {\n          blueprint3d.three.updateWindowSize();\n        }\n\n        handleWindowResize();\n        currentState = newState;\n        updateState(newState);\n        stateChangeCallbacks.fire(newState);\n      }\n\n      function initLeftMenu() {\n        $(window).resize(handleWindowResize);\n        handleWindowResize();\n      }\n\n      function handleWindowResize() {\n        $(\".sidebar\").height(window.innerHeight);\n        $(\"#add-items\").height(window.innerHeight);\n      }\n\n      var initItems = () => {\n        this.initItems(blueprint3d, setCurrentState);\n      };\n\n      init();\n      this.setState({\n        blueprint3d: blueprint3d\n      });\n    };\n\n    this.state = {\n      key: \"chair\",\n      blueprint3d: {},\n      añadirManejadorDeClick: false,\n      currentStateName: \"Design\",\n      blob: \"\"\n    };\n    this.engine = this.engine.bind(this);\n    this.setDesignState = this.setDesignState.bind(this);\n    this.cameraButtons = this.cameraButtons.bind(this);\n    this.contextMenu = this.contextMenu.bind(this);\n    this.modalEffects = this.modalEffects.bind(this);\n    this.sideMenu = this.sideMenu.bind(this);\n    this.textureSelector = this.textureSelector.bind(this);\n    this.initItems = this.initItems.bind(this);\n    this.saveFile = this.saveFile.bind(this);\n    this.loadFile = this.loadFile.bind(this);\n    this.handleLogoutShow = this.handleLogoutShow.bind(this);\n    this.handleModalRepeat = this.handleModalRepeat.bind(this);\n    this.handleModalInfo = this.handleModalInfo.bind(this);\n  }\n\n  saveFile() {\n    if (this.state.blueprint3d.model !== undefined) {\n      var data = this.state.blueprint3d.model.exportSerialized();\n      var a = window.document.createElement(\"a\");\n      var blob = new Blob([data], {\n        type: \"text\"\n      });\n      this.setState({\n        blob: blob\n      });\n      a.href = window.URL.createObjectURL(blob);\n      a.download = \"design.blueprint3d\";\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n    }\n  }\n\n  async loadFile(uri) {\n    try {\n      console.log(\"uri: \" + uri);\n\n      if (uri !== null && uri !== \"\") {\n        let res = await axios.get(BASE_URL + ASSETS + uri);\n        this.state.blueprint3d.model.loadSerialized(JSON.stringify(res.data));\n      } else {\n        console.log(\"uri is null\");\n      }\n    } catch (e) {\n      console.log(e);\n    }\n  }\n  /*\r\n   * Camera Buttons\r\n   */\n\n\n  cameraButtons(blueprint3d) {\n    var orbitControls = blueprint3d.three.controls;\n    var three = blueprint3d.three;\n    var panSpeed = 30;\n    var directions = {\n      UP: 1,\n      DOWN: 2,\n      LEFT: 3,\n      RIGHT: 4\n    };\n\n    function init() {\n      $(\"#zoom-in\").click(zoomIn);\n      $(\"#zoom-in\").on(\"touchend\", zoomIn);\n      $(\"#zoom-out\").click(zoomOut);\n      $(\"#zoom-out\").on(\"touchend\", zoomOut);\n      $(\"#zoom-in\").dblclick(preventDefault);\n      $(\"#zoom-out\").dblclick(preventDefault);\n      $(\"#reset-view\").click(three.centerCamera);\n      $(\"#reset-view\").on(\"touchend\", three.centerCamera);\n      $(\"#move-left\").click(function () {\n        pan(directions.LEFT);\n      });\n      $(\"#move-left\").on(\"touchend\", function () {\n        pan(directions.LEFT);\n      });\n      $(\"#move-right\").click(function () {\n        pan(directions.RIGHT);\n      });\n      $(\"#move-right\").on(\"touchend\", function () {\n        pan(directions.RIGHT);\n      });\n      $(\"#move-up\").click(function () {\n        pan(directions.UP);\n      });\n      $(\"#move-up\").on(\"touchend\", function () {\n        pan(directions.UP);\n      });\n      $(\"#move-down\").click(function () {\n        pan(directions.DOWN);\n      });\n      $(\"#move-down\").on(\"touchend\", function () {\n        pan(directions.DOWN);\n      });\n      $(\"#move-left\").dblclick(preventDefault);\n      $(\"#move-right\").dblclick(preventDefault);\n      $(\"#move-up\").dblclick(preventDefault);\n      $(\"#move-down\").dblclick(preventDefault);\n    }\n\n    function preventDefault(e) {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n\n    function pan(direction) {\n      switch (direction) {\n        case directions.UP:\n          orbitControls.panXY(0, panSpeed);\n          break;\n\n        case directions.DOWN:\n          orbitControls.panXY(0, -panSpeed);\n          break;\n\n        case directions.LEFT:\n          orbitControls.panXY(panSpeed, 0);\n          break;\n\n        case directions.RIGHT:\n          orbitControls.panXY(-panSpeed, 0);\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    function zoomIn(e) {\n      e.preventDefault();\n      orbitControls.dollyIn(1.1);\n      orbitControls.update();\n    }\n\n    function zoomOut(e) {\n      // eslint-disable-next-line no-unused-expressions\n      e.preventDefault;\n      orbitControls.dollyOut(1.1);\n      orbitControls.update();\n    }\n\n    init();\n    this.setState({\n      blueprint3d: blueprint3d\n    });\n  }\n  /*\r\n   * Context menu for selected item\r\n   */\n\n\n  contextMenu(blueprint3d) {\n    const three = blueprint3d.three;\n    let selectedItem = null;\n\n    const init = () => {\n      // Configurar el botón de eliminar en el menú contextual\n      $(\"#context-menu-delete\").on(\"click touchend\", function () {\n        if (selectedItem) selectedItem.remove();\n      }); // Añadir los callbacks para selección y deselección de items\n\n      three.itemSelectedCallbacks.add(handleItemSelected);\n      three.itemUnselectedCallbacks.add(handleItemUnselected); // Configurar el evento para el checkbox de \"fixed\"\n\n      $(\"#fixed\").click(function () {\n        const checked = $(this).prop(\"checked\");\n        if (selectedItem) selectedItem.setFixed(checked);\n      }); // Inicializar eventos de redimensionamiento\n\n      initResize();\n    }; // Conversión de cm a pulgadas\n\n\n    const cmToIn = cm => cm / 2.54; // Conversión de pulgadas a cm\n\n\n    const inToCm = inches => inches * 2.54; // Manejador cuando un item es seleccionado\n\n\n    const handleItemSelected = item => {\n      selectedItem = item;\n      $(\"#context-menu-name\").text(item.metadata.itemName);\n      $(\"#item-width\").val(cmToIn(selectedItem.getWidth()).toFixed(0));\n      $(\"#item-height\").val(cmToIn(selectedItem.getHeight()).toFixed(0));\n      $(\"#item-depth\").val(cmToIn(selectedItem.getDepth()).toFixed(0));\n      $(\"#item-elevation\").val(cmToIn(selectedItem.getElevation()).toFixed(0));\n      $(\"texture-context-container\").show();\n      $(\"#context-menu\").show();\n\n      if (selectedItem.isElevationAdjustable()) {\n        $(\"#item-elevation-div\").show();\n      } else {\n        $(\"#item-elevation-div\").hide();\n      }\n\n      $(\"#fixed\").prop(\"checked\", item.fixed);\n    }; // Manejador cuando un item es deseleccionado\n\n\n    const handleItemUnselected = () => {\n      selectedItem = null;\n      $(\"texture-context-container\").hide();\n      $(\"#context-menu\").hide();\n    }; // Función para redimensionar el item seleccionado\n\n\n    const resize = () => {\n      if (selectedItem) {\n        selectedItem.resize(inToCm($(\"#item-height\").val()), inToCm($(\"#item-width\").val()), inToCm($(\"#item-depth\").val()));\n      }\n    }; // Función para ajustar la elevación del item seleccionado\n\n\n    const elevate = () => {\n      if (selectedItem) {\n        selectedItem.elevate(inToCm($(\"#item-elevation\").val()));\n      }\n    }; // Inicializar eventos de redimensionamiento\n\n\n    const initResize = () => {\n      $(\"#item-height\").change(resize);\n      $(\"#item-width\").change(resize);\n      $(\"#item-depth\").change(resize);\n      $(\"#item-elevation\").change(elevate);\n    }; // Llamada a la función de inicialización\n\n\n    init();\n    this.setState({\n      blueprint3d: blueprint3d\n    });\n  }\n  /*\r\n   * Loading modal for items\r\n   */\n\n\n  modalEffects(blueprint3d) {\n    var scope = this;\n    var itemsLoading = 0;\n\n    const itemSelected = item => {\n      this.selectedItem = item; // Update UI for selected item\n    };\n\n    const itemUnselected = () => {\n      this.selectedItem = null; // Update UI for unselected item\n    };\n\n    this.setActiveItem = function (active) {\n      itemSelected = active;\n      update();\n    };\n\n    function update() {\n      if (itemsLoading > 0) {\n        $(\"#loading-modal\").show();\n      } else {\n        $(\"#loading-modal\").hide();\n      }\n    }\n\n    function init() {\n      blueprint3d.model.scene.itemLoadingCallbacks.add(function () {\n        itemsLoading += 1;\n        update();\n      });\n      blueprint3d.model.scene.itemLoadedCallbacks.add(function () {\n        itemsLoading -= 1;\n        update();\n      });\n      update();\n    }\n\n    init();\n    this.setState({\n      blueprint3d: blueprint3d\n    });\n  }\n  /*\r\n   * Side menu\r\n   */\n\n\n  initItems(blueprint3d, setCurrentState) {\n    $(\"#add-items\").find(\".add-item\").off(\"click\");\n    $(\"#add-items\").find(\".add-item\").click(function (e) {\n      var modelUrl = $(this).attr(\"model-url\");\n      var itemType = parseInt($(this).attr(\"model-type\"));\n      var metadata = {\n        itemName: $(this).attr(\"model-name\"),\n        resizable: true,\n        modelUrl: modelUrl,\n        itemType: itemType\n      };\n      blueprint3d.model.scene.addItem(itemType, modelUrl, metadata);\n      setCurrentState({\n        div: $(\"#viewer\"),\n        tab: $(\"#design_tab\"),\n        name: \"Design\"\n      }, false);\n    });\n  }\n  /*\r\n   * Change floor and wall textures\r\n   */\n\n\n  textureSelector(blueprint3d, sideMenu) {\n    const three = blueprint3d.three;\n    let currentTarget = null;\n\n    function initTextureSelectors() {\n      // Seleccionar textura cuando se hace clic en una miniatura de textura\n      $(\".texture-select-thumbnail\").off(\"click\").on(\"click\", function (e) {\n        e.preventDefault();\n        if (!currentTarget) return;\n        const textureUrl = $(this).attr(\"texture-url\");\n        const textureStretch = $(this).attr(\"texture-stretch\") === \"true\";\n        const textureScale = parseInt($(this).attr(\"texture-scale\"), 10);\n        currentTarget.setTexture(textureUrl, textureStretch, textureScale);\n      });\n    }\n\n    function hideAllTextureMenus() {\n      $(\"texture-context-container\").hide();\n      $(\"#wallTextures\").hide();\n      $(\"#floorTexturesDiv\").hide();\n    }\n\n    function init() {\n      // Configurar los eventos de click para las paredes y el piso\n      three.wallClicked.add(wallClicked);\n      three.floorClicked.add(floorClicked);\n      three.nothingClicked.add(reset); // Llamar a reset cuando el estado del menú cambie\n\n      if (sideMenu && sideMenu.stateChangeCallbacks) {\n        sideMenu.stateChangeCallbacks.add(reset);\n      }\n\n      initTextureSelectors(); // Inicializar los selectores de textura\n    }\n\n    function wallClicked(halfEdge) {\n      if (currentTarget) {\n        currentTarget.removeOutline();\n      }\n\n      currentTarget = halfEdge;\n      currentTarget.drawOutline(); // Mostrar el menú de texturas de paredes\n\n      hideAllTextureMenus();\n      $(\"texture-context-container\").show();\n      $(\"#wallTextures\").show();\n    }\n\n    function floorClicked(room) {\n      if (currentTarget) {\n        currentTarget.removeOutline();\n      }\n\n      currentTarget = room;\n      currentTarget.drawOutline(); // Mostrar el menú de texturas de piso\n\n      hideAllTextureMenus();\n      $(\"texture-context-container\").show();\n      $(\"#floorTexturesDiv\").show();\n    }\n\n    function reset() {\n      if (currentTarget) {\n        currentTarget.removeOutline();\n      }\n\n      currentTarget = null; // Ocultar los menús de textura\n\n      hideAllTextureMenus();\n    }\n\n    init();\n  }\n\n  handleLogoutShow(e) {\n    e.preventDefault();\n    this.props.store.cambiarModuloLogout(true);\n  }\n\n  handleModalRepeat(e) {\n    e.preventDefault();\n    this.props.store.cambiarModuloRepetir(true);\n  }\n\n  handleModalInfo(e) {\n    e.preventDefault();\n    this.props.store.cambiarModuloInformacion(true);\n  }\n\n  async engine(viewKey) {\n    /*\r\n     * Floorplanner controls\r\n     */\n    var ViewerFloorplanner = function (blueprint3d) {\n      var canvasWrapper = \"#floorplanner\";\n      var move = \"#move\";\n      var remove = \"#delete\";\n      var draw = \"#draw\";\n      var activeStlye = \"btn-primary disabled\";\n      this.floorplanner = blueprint3d.floorplanner;\n      var scope = this;\n\n      function init() {\n        $(window).resize(scope.handleWindowResize);\n        scope.handleWindowResize();\n        scope.floorplanner.modeResetCallbacks.add(function (mode) {\n          $(draw).removeClass(activeStlye);\n          $(remove).removeClass(activeStlye);\n          $(move).removeClass(activeStlye);\n\n          if (mode === BP3D.Floorplanner.floorplannerModes.MOVE) {\n            $(move).addClass(activeStlye);\n          } else if (mode === BP3D.Floorplanner.floorplannerModes.DRAW) {\n            $(draw).addClass(activeStlye);\n          } else if (mode === BP3D.Floorplanner.floorplannerModes.DELETE) {\n            $(remove).addClass(activeStlye);\n          }\n\n          if (mode === BP3D.Floorplanner.floorplannerModes.DRAW) {\n            $(\"#draw-walls-hint\").show();\n            scope.handleWindowResize();\n          } else {\n            $(\"#draw-walls-hint\").hide();\n          }\n        });\n        $(move).click(function () {\n          scope.floorplanner.setMode(BP3D.Floorplanner.floorplannerModes.MOVE);\n        });\n        $(move).on(\"touchend\", function () {\n          scope.floorplanner.setMode(BP3D.Floorplanner.floorplannerModes.MOVE);\n        });\n        $(draw).click(function () {\n          scope.floorplanner.setMode(BP3D.Floorplanner.floorplannerModes.DRAW);\n        });\n        $(draw).on(\"touchend\", function () {\n          scope.floorplanner.setMode(BP3D.Floorplanner.floorplannerModes.DRAW);\n        });\n        $(remove).click(function () {\n          scope.floorplanner.setMode(BP3D.Floorplanner.floorplannerModes.DELETE);\n        });\n        $(remove).on(\"touchend\", function () {\n          scope.floorplanner.setMode(BP3D.Floorplanner.floorplannerModes.DELETE);\n        });\n      }\n\n      this.updateFloorplanView = function () {\n        scope.floorplanner.reset();\n      };\n\n      this.handleWindowResize = function () {\n        $(canvasWrapper).height(window.innerHeight - $(canvasWrapper).offset().top);\n        scope.floorplanner.resizeView();\n      };\n\n      init();\n    };\n\n    var mainControls = function (blueprint3d) {\n      function newDesign() {\n        blueprint3d.model.loadSerialized(NEW_STRUCTURE);\n      }\n\n      var loadDesign = async event => {\n        let name = $(\"#loadFile\").attr(\"name\");\n        let file1 = await axios.get(\"http:localhost:8001/assets/\" + name);\n        var reader = new FileReader();\n\n        reader.onload = function () {\n          var data = reader.result;\n          blueprint3d.model.loadSerialized(data);\n        };\n\n        reader.readAsText(file1);\n        $(\"#loadFile\").replaceWith($(\"#loadFile\").val(\"\").clone(true));\n\n        try {\n          let uri = $(\"#loadFile\").attr(\"uri\");\n          console.log(\"uri: \" + uri);\n\n          if (uri !== \"\") {\n            let res = await axios.get(\"http:localhost:8001/assets/\" + uri);\n            blueprint3d.model.loadSerialized(JSON.stringify(res.data));\n          }\n        } catch (e) {\n          console.log(e);\n        }\n      };\n\n      function saveDesign() {\n        var data = blueprint3d.model.exportSerialized();\n        var a = window.document.createElement(\"a\");\n        var blob = new Blob([data], {\n          type: \"text\"\n        });\n        a.href = window.URL.createObjectURL(blob);\n        a.download = \"design\";\n        document.body.appendChild(a);\n        a.click();\n        document.body.removeChild(a);\n      }\n\n      function init() {\n        $(\"#new\").click(newDesign);\n        $(\"#new\").on(\"touchend\", newDesign);\n        $(\"#loadFile\").click(loadDesign);\n        $(\"#loadFileLabel\").on(\"touchend\", function () {\n          $(\"#loadFile\").trigger(\"click\");\n        });\n        $(\"#saveFile\").click(saveDesign);\n        $(\"#saveFile\").on(\"touchend\", saveDesign);\n      }\n\n      init();\n    };\n    /*\r\n     * Initialize!\r\n     */\n\n\n    var modalEffects = this.modalEffects(this.state.blueprint3d);\n    var viewerFloorplanner = new ViewerFloorplanner(this.state.blueprint3d);\n    var contextMenu = this.contextMenu(this.state.blueprint3d);\n    var sideMenu = this.sideMenu(this.state.blueprint3d, viewerFloorplanner, modalEffects); // Verificar si sideMenu se inicializó correctamente\n\n    if (sideMenu) {\n      sideMenu.stateChangeCallbacks = $.Callbacks();\n    } else {\n      console.error(\"sideMenu no se pudo inicializar correctamente\");\n      return; // Detener ejecución si `sideMenu` es `undefined`\n    }\n\n    var textureSelector = this.textureSelector(this.state.blueprint3d, sideMenu);\n    var cameraButtons = this.cameraButtons(this.state.blueprint3d);\n    mainControls(this.state.blueprint3d);\n\n    if (viewKey === \"\") {\n      this.state.blueprint3d.model.loadSerialized(INIT_STRUCTURE);\n    } else {\n      try {\n        let res = await axios.get(BASE_URL + ASSETS + viewKey);\n        let file1 = new Blob(res);\n        var blueprint3d = this.state.blueprint3d;\n        var reader = new FileReader();\n\n        reader.onload = function () {\n          var data = reader.result;\n          blueprint3d.model.loadSerialized(data);\n        };\n\n        reader.readAsText(file1);\n        this.state.blueprint3d.model.loadSerialized(JSON.stringify(res.data));\n      } catch (e) {\n        console.log(e);\n        this.state.blueprint3d.model.loadSerialized(INIT_STRUCTURE);\n      }\n    }\n  }\n\n  componentDidMount() {\n    const {\n      store\n    } = this.props;\n    var opts = {\n      floorplannerElement: \"floorplanner-canvas\",\n      threeElement: \"#viewer\",\n      threeCanvasElement: \"three-canvas\",\n      textureDir: \"rooms/textures/\",\n      widget: false\n    };\n    this.setState({\n      blueprint3d: new BP3D.Blueprint3d(opts)\n    }, () => {\n      if (this.props.viewKey !== undefined && this.props.viewKey !== null && this.props.viewKey !== \"\") {\n        this.engine(this.props.viewKey);\n      } else {\n        this.engine(\"\");\n      }\n    });\n  }\n\n  setDesignState(newState, firstTime) {\n    firstTime = firstTime || false;\n    var ACTIVE_CLASS = \"active\";\n    $(\"#items_tab\").removeClass(ACTIVE_CLASS);\n    $(\"#design_tab\").addClass(ACTIVE_CLASS);\n    $(\"#add-items\").hide();\n    $(\"#viewer\").show();\n    this.state.blueprint3d.three.updateWindowSize();\n\n    function handleWindowResize() {\n      $(\".sidebar\").height(window.innerHeight);\n      $(\"#add-items\").height(window.innerHeight);\n    }\n\n    handleWindowResize();\n\n    function reset() {\n      $(\"texture-context-container\").hide();\n      $(\"#wallTextures\").hide();\n      $(\"#floorTexturesDiv\").hide();\n    }\n\n    reset();\n    this.setState({\n      currentStateName: \"Design\"\n    });\n  }\n\n  componentDidUpdate(prevProps, prevState, snapShot) {\n    if (this.props.añadirManejadorDeClick) {\n      this.setState({\n        añadirManejadorDeClick: true\n      });\n      this.props.store.cambiarManejadorDeClick(false);\n      this.initItems(this.state.blueprint3d, this.setDesignState);\n    }\n\n    if (this.props.añadirManejadorDeClick === false && prevProps.añadirManejadorDeClick) {\n      this.setState({\n        añadirManejadorDeClick: false\n      });\n    }\n  }\n\n  render() {\n    const {\n      store\n    } = this.props;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"horizontal-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 892,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"texture-context-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 895,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"context-menu\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 897,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(ContextMenu, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 898,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"floorTexturesDiv\",\n      style: {\n        display: \"none\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 901,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(FloorTextureList, {\n      usuarioHaIniciadoSesion: store.obtenerInicioDeSesion,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 902,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"wallTextures\",\n      style: {\n        display: \"none\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 908,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(WallTextureList, {\n      usuarioHaIniciadoSesion: store.obtenerInicioDeSesion,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 909,\n        columnNumber: 13\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"right-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 917,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"viewer\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 919,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"loading-modal\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 982,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 983,\n        columnNumber: 15\n      }\n    }, \"Loading...\"))), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"floorplanner\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 988,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"canvas\", {\n      id: \"floorplanner-canvas\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 989,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"floorplanner-controls\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 990,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      variant: \"info\",\n      size: \"sm\",\n      className: \"icon-text-button\",\n      id: \"update-floorplan\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1025,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"text-centre\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1031,\n        columnNumber: 17\n      }\n    }, \"Listo\"), /*#__PURE__*/React.createElement(\"span\", {\n      className: \"icon-centre\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1032,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(FaChevronRight, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1033,\n        columnNumber: 19\n      }\n    })))), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"draw-walls-hint\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1037,\n        columnNumber: 13\n      }\n    }, \"Press the \\\"Esc\\\" key to stop drawing walls\")), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"add-items\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1042,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Tabs, {\n      variant: \"pills\",\n      style: {\n        display: \"flex\",\n        flexDirection: \"column\",\n        width: \"100px\",\n        position: \"absolute\",\n        right: \"100px\",\n        top: \"100px\"\n      },\n      id: \"controlled-tab-example\",\n      activeKey: this.state.key,\n      onSelect: k => {\n        this.setState({\n          key: k\n        });\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1043,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Tab, {\n      eventKey: \"chair\",\n      title: \"Sillas\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1062,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(CardListChair, {\n      usuarioHaIniciadoSesion: store.obtenerInicioDeSesion,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1063,\n        columnNumber: 17\n      }\n    })), /*#__PURE__*/React.createElement(Tab, {\n      eventKey: \"rug\",\n      title: \"Alfombras\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1067,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(CardListRug, {\n      usuarioHaIniciadoSesion: store.obtenerInicioDeSesion,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1068,\n        columnNumber: 17\n      }\n    })), /*#__PURE__*/React.createElement(Tab, {\n      eventKey: \"misc\",\n      title: \"Oficina personal y corporativa\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1072,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(CardListMisc, {\n      usuarioHaIniciadoSesion: store.obtenerInicioDeSesion,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1073,\n        columnNumber: 17\n      }\n    })), /*#__PURE__*/React.createElement(Tab, {\n      eventKey: \"light\",\n      title: \"Luces\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1077,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(CardListLight, {\n      usuarioHaIniciadoSesion: store.obtenerInicioDeSesion,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1078,\n        columnNumber: 17\n      }\n    })))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"menu\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1090,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      display: \"flex\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1091,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"ul\", {\n      className: \"nav nav-sidebar\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1092,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"li\", {\n      id: \"design_tab\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1093,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(OverlayTrigger, {\n      placement: \"right\",\n      overlay: /*#__PURE__*/React.createElement(Tooltip, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1096,\n          columnNumber: 30\n        }\n      }, \"Dise\\xF1ar\"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1094,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"icons\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1098,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"iconWrapper\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1099,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(FaCube, {\n      size: \"25px\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1100,\n        columnNumber: 25\n      }\n    }))))), /*#__PURE__*/React.createElement(\"li\", {\n      id: \"floorplan_tab\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1105,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(OverlayTrigger, {\n      placement: \"right\",\n      overlay: /*#__PURE__*/React.createElement(Tooltip, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1108,\n          columnNumber: 30\n        }\n      }, \"Editar piso\"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1106,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"icons\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1110,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"iconWrapper\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1111,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(FaPenFancy, {\n      size: \"25px\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1112,\n        columnNumber: 25\n      }\n    }))))), /*#__PURE__*/React.createElement(\"li\", {\n      id: \"items_tab\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1117,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(OverlayTrigger, {\n      placement: \"right\",\n      overlay: /*#__PURE__*/React.createElement(Tooltip, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1120,\n          columnNumber: 30\n        }\n      }, \"A\\xF1adir objeto\"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1118,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"icons\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1122,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"iconWrapper\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1123,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(FaPlus, {\n      size: \"25px\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1124,\n        columnNumber: 25\n      }\n    }))))), /*#__PURE__*/React.createElement(\"li\", {\n      id: \"items_tab\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1129,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: \"./logo.png\",\n      className: \"top-bar-logo\",\n      alt: \"\",\n      style: {\n        width: \"100px\",\n        height: \"100px\",\n        margin: \"-5px 10px 0 10px\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1130,\n        columnNumber: 19\n      }\n    })), /*#__PURE__*/React.createElement(\"li\", {\n      style: {\n        display: \"none\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1141,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(OverlayTrigger, {\n      placement: \"right\",\n      overlay: /*#__PURE__*/React.createElement(Tooltip, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1144,\n          columnNumber: 30\n        }\n      }, \"Repetir plano\"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1142,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      className: \"repeatButton\",\n      onClick: this.handleModalRepeat,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1146,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"icons\",\n      id: \"new\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1150,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"iconWrapper\",\n      style: {\n        margin: 0,\n        padding: 0\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1151,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(FaRedo, {\n      size: \"25px\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1155,\n        columnNumber: 27\n      }\n    })))))), /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1161,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(OverlayTrigger, {\n      placement: \"right\",\n      overlay: /*#__PURE__*/React.createElement(Tooltip, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1164,\n          columnNumber: 30\n        }\n      }, \"Repetir plano\"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1162,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      className: \"repeatButton\",\n      onClick: this.handleModalRepeat,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1166,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"icons\",\n      id: \"new\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1170,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"iconWrapper\",\n      style: {\n        margin: 0,\n        padding: 0\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1171,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(FaRedo, {\n      size: \"25px\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1175,\n        columnNumber: 27\n      }\n    })))))), /*#__PURE__*/React.createElement(\"li\", {\n      id: \"design_tab\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1181,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(ScreenCaptureButton, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1182,\n        columnNumber: 19\n      }\n    })), /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1184,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(OverlayTrigger, {\n      placement: \"right\",\n      overlay: /*#__PURE__*/React.createElement(Tooltip, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1187,\n          columnNumber: 30\n        }\n      }, \"Informaci\\xF3n\"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1185,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      className: \"repeatButton\",\n      onClick: this.handleModalInfo,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1189,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"icons\",\n      id: \"new\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1193,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"iconWrapper\",\n      style: {\n        margin: 0,\n        padding: 0\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1194,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(FaInfoCircle, {\n      size: \"25px\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1198,\n        columnNumber: 27\n      }\n    })))))), /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1204,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      variant: \"outline-dark\",\n      className: \"top-bar-login-button\",\n      style: {\n        position: \"absolute\",\n        top: \"10px\",\n        right: 0\n      },\n      onClick: this.handleLogoutShow,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1205,\n        columnNumber: 19\n      }\n    }, \"Salir\")))))));\n  }\n\n}, _temp)) || _class) || _class);\nexport default AppContenido;","map":{"version":3,"sources":["C:/Users/carli/OneDrive/Escritorio/Dev/astrid/InteriorDesing/src/Components/AppContenido.jsx"],"names":["React","Component","$","axios","BP3D","INIT_STRUCTURE","NEW_STRUCTURE","BASE_URL","ASSETS","TopBarButton","Button","FaSearchMinus","FaSearchPlus","FaHome","FaArrowUp","FaArrowDown","FaArrowLeft","FaArrowRight","FaChevronRight","FaArrowsAlt","FaPencilAlt","FaTrashAlt","FaPencilRuler","FaDraftingCompass","FaPlus","FaRedo","FaCamera","FaPenFancy","FaCube","FaInfoCircle","Tabs","Tab","OverlayTrigger","Tooltip","CardListSofa","CardListChair","CardListRug","CardListMisc","CardListKitchen","CardListArch","CardListLight","FloorTextureList","WallTextureList","ContextMenu","SaveButton","LoadButton","SaveModal","LoadModal","inject","observer","ScreenCaptureButton","AppContenido","constructor","props","sideMenu","blueprint3d","floorplanControls","modalEffects","ACTIVE_CLASS","stateChangeCallbacks","Callbacks","tabs","FLOORPLAN","SHOP","DESIGN","scope","states","DEFAULT","div","tab","name","currentState","init","elem","click","tabClicked","floorplanUpdate","reset","hide","add","initLeftMenu","three","updateWindowSize","handleWindowResize","initItems","setCurrentState","stopSpin","key","state","getCurrentState","currentStateName","updateState","newState","setState","firstTime","removeClass","addClass","getController","setSelectedObject","show","updateFloorplanView","model","floorplan","update","fire","window","resize","height","innerHeight","añadirManejadorDeClick","blob","engine","bind","setDesignState","cameraButtons","contextMenu","textureSelector","saveFile","loadFile","handleLogoutShow","handleModalRepeat","handleModalInfo","undefined","data","exportSerialized","a","document","createElement","Blob","type","href","URL","createObjectURL","download","body","appendChild","removeChild","uri","console","log","res","get","loadSerialized","JSON","stringify","e","orbitControls","controls","panSpeed","directions","UP","DOWN","LEFT","RIGHT","zoomIn","on","zoomOut","dblclick","preventDefault","centerCamera","pan","stopPropagation","direction","panXY","dollyIn","dollyOut","selectedItem","remove","itemSelectedCallbacks","handleItemSelected","itemUnselectedCallbacks","handleItemUnselected","checked","prop","setFixed","initResize","cmToIn","cm","inToCm","inches","item","text","metadata","itemName","val","getWidth","toFixed","getHeight","getDepth","getElevation","isElevationAdjustable","fixed","elevate","change","itemsLoading","itemSelected","itemUnselected","setActiveItem","active","scene","itemLoadingCallbacks","itemLoadedCallbacks","find","off","modelUrl","attr","itemType","parseInt","resizable","addItem","currentTarget","initTextureSelectors","textureUrl","textureStretch","textureScale","setTexture","hideAllTextureMenus","wallClicked","floorClicked","nothingClicked","halfEdge","removeOutline","drawOutline","room","store","cambiarModuloLogout","cambiarModuloRepetir","cambiarModuloInformacion","viewKey","ViewerFloorplanner","canvasWrapper","move","draw","activeStlye","floorplanner","modeResetCallbacks","mode","Floorplanner","floorplannerModes","MOVE","DRAW","DELETE","setMode","offset","top","resizeView","mainControls","newDesign","loadDesign","event","file1","reader","FileReader","onload","result","readAsText","replaceWith","clone","saveDesign","trigger","viewerFloorplanner","error","componentDidMount","opts","floorplannerElement","threeElement","threeCanvasElement","textureDir","widget","Blueprint3d","componentDidUpdate","prevProps","prevState","snapShot","cambiarManejadorDeClick","render","display","obtenerInicioDeSesion","flexDirection","width","position","right","k","margin","padding"],"mappings":"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","sourcesContent":["import \"../App.css\";\r\nimport React, { Component } from \"react\";\r\nimport $ from \"jquery\";\r\nimport axios from \"axios\";\r\nimport { BP3D } from \"../engine/blueprint3d.js\";\r\nimport { INIT_STRUCTURE, NEW_STRUCTURE } from \"../Structures.js\";\r\nimport { BASE_URL, ASSETS } from \"../Constants.js\";\r\nimport TopBarButton from \"./TopBar/TopBarButton.jsx\";\r\nimport Button from \"react-bootstrap/Button\";\r\nimport {\r\n  FaSearchMinus,\r\n  FaSearchPlus,\r\n  FaHome,\r\n  FaArrowUp,\r\n  FaArrowDown,\r\n  FaArrowLeft,\r\n  FaArrowRight,\r\n  FaChevronRight,\r\n  FaArrowsAlt,\r\n  FaPencilAlt,\r\n  FaTrashAlt,\r\n  FaPencilRuler,\r\n  FaDraftingCompass,\r\n  FaPlus,\r\n  FaRedo,\r\n  FaCamera,\r\n  FaPenFancy,\r\n  FaCube,\r\n  FaInfoCircle,\r\n} from \"react-icons/fa\";\r\nimport { Tabs, Tab, OverlayTrigger, Tooltip } from \"react-bootstrap\";\r\nimport CardListSofa from \"./AddItems/CardListSofa.jsx\";\r\nimport CardListChair from \"./AddItems/CardListChair.jsx\";\r\nimport CardListRug from \"./AddItems/CardListRug.jsx\";\r\nimport CardListMisc from \"./AddItems/CardListMisc.jsx\";\r\nimport CardListKitchen from \"./AddItems/CardListKitchen.jsx\";\r\nimport CardListArch from \"./AddItems/CardListArch.jsx\";\r\nimport CardListLight from \"./AddItems/CardListLight.jsx\";\r\nimport FloorTextureList from \"./TextureList/FloorTextureList.jsx\";\r\nimport WallTextureList from \"./TextureList/WallTextureList.jsx\";\r\nimport ContextMenu from \"./ContextMenu.jsx\";\r\nimport SaveButton from \"./SaveLoadModal/SaveFile/SaveButton.jsx\";\r\nimport LoadButton from \"./SaveLoadModal/LoadFile/LoadButton.jsx\";\r\nimport SaveModal from \"./SaveLoadModal/SaveFile/SaveModal.jsx\";\r\nimport LoadModal from \"./SaveLoadModal/LoadFile/LoadModal.jsx\";\r\n\r\nimport { inject, observer } from \"mobx-react\";\r\nimport ScreenCaptureButton from \"./ScreenCaptureButton\";\r\n\r\n@inject(\"store\")\r\n@observer\r\nclass AppContenido extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      key: \"chair\",\r\n      blueprint3d: {},\r\n      añadirManejadorDeClick: false,\r\n      currentStateName: \"Design\",\r\n      blob: \"\",\r\n    };\r\n    this.engine = this.engine.bind(this);\r\n    this.setDesignState = this.setDesignState.bind(this);\r\n    this.cameraButtons = this.cameraButtons.bind(this);\r\n    this.contextMenu = this.contextMenu.bind(this);\r\n    this.modalEffects = this.modalEffects.bind(this);\r\n    this.sideMenu = this.sideMenu.bind(this);\r\n    this.textureSelector = this.textureSelector.bind(this);\r\n    this.initItems = this.initItems.bind(this);\r\n    this.saveFile = this.saveFile.bind(this);\r\n    this.loadFile = this.loadFile.bind(this);\r\n    this.handleLogoutShow = this.handleLogoutShow.bind(this);\r\n    this.handleModalRepeat = this.handleModalRepeat.bind(this);\r\n    this.handleModalInfo = this.handleModalInfo.bind(this);\r\n  }\r\n\r\n  saveFile() {\r\n    if (this.state.blueprint3d.model !== undefined) {\r\n      var data = this.state.blueprint3d.model.exportSerialized();\r\n      var a = window.document.createElement(\"a\");\r\n      var blob = new Blob([data], {\r\n        type: \"text\",\r\n      });\r\n      this.setState({ blob: blob });\r\n      a.href = window.URL.createObjectURL(blob);\r\n      a.download = \"design.blueprint3d\";\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      document.body.removeChild(a);\r\n    }\r\n  }\r\n\r\n  async loadFile(uri) {\r\n    try {\r\n      console.log(\"uri: \" + uri);\r\n      if (uri !== null && uri !== \"\") {\r\n        let res = await axios.get(BASE_URL + ASSETS + uri);\r\n        this.state.blueprint3d.model.loadSerialized(JSON.stringify(res.data));\r\n      } else {\r\n        console.log(\"uri is null\");\r\n      }\r\n    } catch (e) {\r\n      console.log(e);\r\n    }\r\n  }\r\n\r\n  /*\r\n   * Camera Buttons\r\n   */\r\n  cameraButtons(blueprint3d) {\r\n    var orbitControls = blueprint3d.three.controls;\r\n    var three = blueprint3d.three;\r\n\r\n    var panSpeed = 30;\r\n    var directions = {\r\n      UP: 1,\r\n      DOWN: 2,\r\n      LEFT: 3,\r\n      RIGHT: 4,\r\n    };\r\n\r\n    function init() {\r\n      $(\"#zoom-in\").click(zoomIn);\r\n      $(\"#zoom-in\").on(\"touchend\", zoomIn);\r\n      $(\"#zoom-out\").click(zoomOut);\r\n      $(\"#zoom-out\").on(\"touchend\", zoomOut);\r\n\r\n      $(\"#zoom-in\").dblclick(preventDefault);\r\n      $(\"#zoom-out\").dblclick(preventDefault);\r\n\r\n      $(\"#reset-view\").click(three.centerCamera);\r\n      $(\"#reset-view\").on(\"touchend\", three.centerCamera);\r\n\r\n      $(\"#move-left\").click(function () {\r\n        pan(directions.LEFT);\r\n      });\r\n      $(\"#move-left\").on(\"touchend\", function () {\r\n        pan(directions.LEFT);\r\n      });\r\n\r\n      $(\"#move-right\").click(function () {\r\n        pan(directions.RIGHT);\r\n      });\r\n      $(\"#move-right\").on(\"touchend\", function () {\r\n        pan(directions.RIGHT);\r\n      });\r\n\r\n      $(\"#move-up\").click(function () {\r\n        pan(directions.UP);\r\n      });\r\n      $(\"#move-up\").on(\"touchend\", function () {\r\n        pan(directions.UP);\r\n      });\r\n\r\n      $(\"#move-down\").click(function () {\r\n        pan(directions.DOWN);\r\n      });\r\n      $(\"#move-down\").on(\"touchend\", function () {\r\n        pan(directions.DOWN);\r\n      });\r\n\r\n      $(\"#move-left\").dblclick(preventDefault);\r\n      $(\"#move-right\").dblclick(preventDefault);\r\n      $(\"#move-up\").dblclick(preventDefault);\r\n      $(\"#move-down\").dblclick(preventDefault);\r\n    }\r\n\r\n    function preventDefault(e) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    }\r\n\r\n    function pan(direction) {\r\n      switch (direction) {\r\n        case directions.UP:\r\n          orbitControls.panXY(0, panSpeed);\r\n          break;\r\n        case directions.DOWN:\r\n          orbitControls.panXY(0, -panSpeed);\r\n          break;\r\n        case directions.LEFT:\r\n          orbitControls.panXY(panSpeed, 0);\r\n          break;\r\n        case directions.RIGHT:\r\n          orbitControls.panXY(-panSpeed, 0);\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    }\r\n\r\n    function zoomIn(e) {\r\n      e.preventDefault();\r\n      orbitControls.dollyIn(1.1);\r\n      orbitControls.update();\r\n    }\r\n\r\n    function zoomOut(e) {\r\n      // eslint-disable-next-line no-unused-expressions\r\n      e.preventDefault;\r\n      orbitControls.dollyOut(1.1);\r\n      orbitControls.update();\r\n    }\r\n\r\n    init();\r\n    this.setState({ blueprint3d: blueprint3d });\r\n  }\r\n\r\n  /*\r\n   * Context menu for selected item\r\n   */\r\n  contextMenu(blueprint3d) {\r\n    const three = blueprint3d.three;\r\n    let selectedItem = null;\r\n\r\n    const init = () => {\r\n      // Configurar el botón de eliminar en el menú contextual\r\n      $(\"#context-menu-delete\").on(\"click touchend\", function () {\r\n        if (selectedItem) selectedItem.remove();\r\n      });\r\n\r\n      // Añadir los callbacks para selección y deselección de items\r\n      three.itemSelectedCallbacks.add(handleItemSelected);\r\n      three.itemUnselectedCallbacks.add(handleItemUnselected);\r\n\r\n      // Configurar el evento para el checkbox de \"fixed\"\r\n      $(\"#fixed\").click(function () {\r\n        const checked = $(this).prop(\"checked\");\r\n        if (selectedItem) selectedItem.setFixed(checked);\r\n      });\r\n\r\n      // Inicializar eventos de redimensionamiento\r\n      initResize();\r\n    };\r\n\r\n    // Conversión de cm a pulgadas\r\n    const cmToIn = (cm) => cm / 2.54;\r\n\r\n    // Conversión de pulgadas a cm\r\n    const inToCm = (inches) => inches * 2.54;\r\n\r\n    // Manejador cuando un item es seleccionado\r\n    const handleItemSelected = (item) => {\r\n      selectedItem = item;\r\n\r\n      $(\"#context-menu-name\").text(item.metadata.itemName);\r\n\r\n      $(\"#item-width\").val(cmToIn(selectedItem.getWidth()).toFixed(0));\r\n      $(\"#item-height\").val(cmToIn(selectedItem.getHeight()).toFixed(0));\r\n      $(\"#item-depth\").val(cmToIn(selectedItem.getDepth()).toFixed(0));\r\n      $(\"#item-elevation\").val(cmToIn(selectedItem.getElevation()).toFixed(0));\r\n\r\n      $(\"texture-context-container\").show();\r\n      $(\"#context-menu\").show();\r\n\r\n      if (selectedItem.isElevationAdjustable()) {\r\n        $(\"#item-elevation-div\").show();\r\n      } else {\r\n        $(\"#item-elevation-div\").hide();\r\n      }\r\n\r\n      $(\"#fixed\").prop(\"checked\", item.fixed);\r\n    };\r\n\r\n    // Manejador cuando un item es deseleccionado\r\n    const handleItemUnselected = () => {\r\n      selectedItem = null;\r\n      $(\"texture-context-container\").hide();\r\n      $(\"#context-menu\").hide();\r\n    };\r\n\r\n    // Función para redimensionar el item seleccionado\r\n    const resize = () => {\r\n      if (selectedItem) {\r\n        selectedItem.resize(\r\n          inToCm($(\"#item-height\").val()),\r\n          inToCm($(\"#item-width\").val()),\r\n          inToCm($(\"#item-depth\").val())\r\n        );\r\n      }\r\n    };\r\n\r\n    // Función para ajustar la elevación del item seleccionado\r\n    const elevate = () => {\r\n      if (selectedItem) {\r\n        selectedItem.elevate(inToCm($(\"#item-elevation\").val()));\r\n      }\r\n    };\r\n\r\n    // Inicializar eventos de redimensionamiento\r\n    const initResize = () => {\r\n      $(\"#item-height\").change(resize);\r\n      $(\"#item-width\").change(resize);\r\n      $(\"#item-depth\").change(resize);\r\n      $(\"#item-elevation\").change(elevate);\r\n    };\r\n\r\n    // Llamada a la función de inicialización\r\n    init();\r\n\r\n    this.setState({ blueprint3d: blueprint3d });\r\n  }\r\n\r\n  /*\r\n   * Loading modal for items\r\n   */\r\n  modalEffects(blueprint3d) {\r\n    var scope = this;\r\n    var itemsLoading = 0;\r\n    const itemSelected = (item) => {\r\n      this.selectedItem = item;\r\n      // Update UI for selected item\r\n    };\r\n\r\n    const itemUnselected = () => {\r\n      this.selectedItem = null;\r\n      // Update UI for unselected item\r\n    };\r\n    this.setActiveItem = function (active) {\r\n      itemSelected = active;\r\n      update();\r\n    };\r\n\r\n    function update() {\r\n      if (itemsLoading > 0) {\r\n        $(\"#loading-modal\").show();\r\n      } else {\r\n        $(\"#loading-modal\").hide();\r\n      }\r\n    }\r\n\r\n    function init() {\r\n      blueprint3d.model.scene.itemLoadingCallbacks.add(function () {\r\n        itemsLoading += 1;\r\n        update();\r\n      });\r\n\r\n      blueprint3d.model.scene.itemLoadedCallbacks.add(function () {\r\n        itemsLoading -= 1;\r\n        update();\r\n      });\r\n\r\n      update();\r\n    }\r\n\r\n    init();\r\n    this.setState({ blueprint3d: blueprint3d });\r\n  }\r\n\r\n  /*\r\n   * Side menu\r\n   */\r\n  sideMenu = function (blueprint3d, floorplanControls, modalEffects) {\r\n    var modalEffects = modalEffects;\r\n\r\n    var ACTIVE_CLASS = \"active\";\r\n    var stateChangeCallbacks = $.Callbacks();\r\n\r\n    var tabs = {\r\n      FLOORPLAN: $(\"#floorplan_tab\"),\r\n      SHOP: $(\"#items_tab\"),\r\n      DESIGN: $(\"#design_tab\"),\r\n    };\r\n\r\n    var scope = this;\r\n    var stateChangeCallbacks = $.Callbacks();\r\n\r\n    var states = {\r\n      DEFAULT: {\r\n        div: $(\"#viewer\"),\r\n        tab: tabs.DESIGN,\r\n        name: \"Design\",\r\n      },\r\n      FLOORPLAN: {\r\n        div: $(\"#floorplanner\"),\r\n        tab: tabs.FLOORPLAN,\r\n        name: \"Floorplan\",\r\n      },\r\n      SHOP: {\r\n        div: $(\"#add-items\"),\r\n        tab: tabs.SHOP,\r\n        name: \"Shop\",\r\n      },\r\n    };\r\n\r\n    var currentState = states.FLOORPLAN;\r\n\r\n    function init() {\r\n      for (var tab in tabs) {\r\n        var elem = tabs[tab];\r\n        elem.click(tabClicked(elem));\r\n      }\r\n\r\n      $(\"#update-floorplan\").click(floorplanUpdate);\r\n      function reset() {\r\n        $(\"texture-context-container\").hide();\r\n        $(\"#wallTextures\").hide();\r\n        $(\"#floorTexturesDiv\").hide();\r\n      }\r\n      stateChangeCallbacks.add(reset);\r\n\r\n      initLeftMenu();\r\n\r\n      blueprint3d.three.updateWindowSize();\r\n      handleWindowResize();\r\n\r\n      initItems();\r\n\r\n      setCurrentState(states.DEFAULT, true);\r\n    }\r\n\r\n    function floorplanUpdate() {\r\n      setCurrentState(states.DEFAULT);\r\n    }\r\n\r\n    function tabClicked(tab) {\r\n      return function () {\r\n        initItems();\r\n        blueprint3d.three.stopSpin();\r\n\r\n        for (var key in states) {\r\n          var state = states[key];\r\n          if (state.tab === tab) {\r\n            setCurrentState(state);\r\n            break;\r\n          }\r\n        }\r\n      };\r\n    }\r\n\r\n    var getCurrentState = () => {\r\n      if (this.state.currentStateName === \"Design\") {\r\n        return states.DEFAULT;\r\n      }\r\n      if (this.state.currentStateName === \"Floorplan\") {\r\n        return states.FLOORPLAN;\r\n      }\r\n      if (this.state.currentStateName === \"Shop\") {\r\n        return states.SHOP;\r\n      }\r\n      return null;\r\n    };\r\n\r\n    var updateState = (newState) => {\r\n      this.setState({ currentStateName: newState.name });\r\n    };\r\n\r\n    function setCurrentState(newState, firstTime) {\r\n      currentState = getCurrentState();\r\n      firstTime = firstTime || false;\r\n      if (!firstTime && currentState.name === newState.name) {\r\n        return;\r\n      }\r\n\r\n      if (currentState.name !== newState.name) {\r\n        if (currentState.tab != null) {\r\n          currentState.tab.removeClass(ACTIVE_CLASS);\r\n        }\r\n        if (newState.tab != null) {\r\n          newState.tab.addClass(ACTIVE_CLASS);\r\n        }\r\n      }\r\n\r\n      if (currentState.name === newState.name) {\r\n        newState.tab.addClass(ACTIVE_CLASS);\r\n      }\r\n\r\n      if (firstTime || newState.name !== \"Design\") {\r\n        blueprint3d.three.getController().setSelectedObject(null);\r\n      }\r\n\r\n      currentState.div.hide();\r\n      newState.div.show();\r\n\r\n      if (newState === states.FLOORPLAN) {\r\n        floorplanControls.handleWindowResize();\r\n        floorplanControls.updateFloorplanView();\r\n      }\r\n\r\n      if (currentState === states.FLOORPLAN) {\r\n        blueprint3d.model.floorplan.update();\r\n      }\r\n\r\n      if (newState === states.DEFAULT) {\r\n        blueprint3d.three.updateWindowSize();\r\n      }\r\n\r\n      handleWindowResize();\r\n      currentState = newState;\r\n      updateState(newState);\r\n\r\n      stateChangeCallbacks.fire(newState);\r\n    }\r\n\r\n    function initLeftMenu() {\r\n      $(window).resize(handleWindowResize);\r\n      handleWindowResize();\r\n    }\r\n\r\n    function handleWindowResize() {\r\n      $(\".sidebar\").height(window.innerHeight);\r\n      $(\"#add-items\").height(window.innerHeight);\r\n    }\r\n\r\n    var initItems = () => {\r\n      this.initItems(blueprint3d, setCurrentState);\r\n    };\r\n\r\n    init();\r\n    this.setState({ blueprint3d: blueprint3d });\r\n  };\r\n\r\n  initItems(blueprint3d, setCurrentState) {\r\n    $(\"#add-items\").find(\".add-item\").off(\"click\");\r\n    $(\"#add-items\")\r\n      .find(\".add-item\")\r\n      .click(function (e) {\r\n        var modelUrl = $(this).attr(\"model-url\");\r\n        var itemType = parseInt($(this).attr(\"model-type\"));\r\n        var metadata = {\r\n          itemName: $(this).attr(\"model-name\"),\r\n          resizable: true,\r\n          modelUrl: modelUrl,\r\n          itemType: itemType,\r\n        };\r\n\r\n        blueprint3d.model.scene.addItem(itemType, modelUrl, metadata);\r\n        setCurrentState(\r\n          {\r\n            div: $(\"#viewer\"),\r\n            tab: $(\"#design_tab\"),\r\n            name: \"Design\",\r\n          },\r\n          false\r\n        );\r\n      });\r\n  }\r\n\r\n  /*\r\n   * Change floor and wall textures\r\n   */\r\n  textureSelector(blueprint3d, sideMenu) {\r\n    const three = blueprint3d.three;\r\n    let currentTarget = null;\r\n\r\n    function initTextureSelectors() {\r\n      // Seleccionar textura cuando se hace clic en una miniatura de textura\r\n      $(\".texture-select-thumbnail\")\r\n        .off(\"click\")\r\n        .on(\"click\", function (e) {\r\n          e.preventDefault();\r\n          if (!currentTarget) return;\r\n\r\n          const textureUrl = $(this).attr(\"texture-url\");\r\n          const textureStretch = $(this).attr(\"texture-stretch\") === \"true\";\r\n          const textureScale = parseInt($(this).attr(\"texture-scale\"), 10);\r\n          currentTarget.setTexture(textureUrl, textureStretch, textureScale);\r\n        });\r\n    }\r\n\r\n    function hideAllTextureMenus() {\r\n      $(\"texture-context-container\").hide();\r\n      $(\"#wallTextures\").hide();\r\n      $(\"#floorTexturesDiv\").hide();\r\n    }\r\n\r\n    function init() {\r\n      // Configurar los eventos de click para las paredes y el piso\r\n      three.wallClicked.add(wallClicked);\r\n      three.floorClicked.add(floorClicked);\r\n      three.nothingClicked.add(reset);\r\n\r\n      // Llamar a reset cuando el estado del menú cambie\r\n      if (sideMenu && sideMenu.stateChangeCallbacks) {\r\n        sideMenu.stateChangeCallbacks.add(reset);\r\n      }\r\n\r\n      initTextureSelectors(); // Inicializar los selectores de textura\r\n    }\r\n\r\n    function wallClicked(halfEdge) {\r\n      if (currentTarget) {\r\n        currentTarget.removeOutline();\r\n      }\r\n      currentTarget = halfEdge;\r\n      currentTarget.drawOutline();\r\n\r\n      // Mostrar el menú de texturas de paredes\r\n      hideAllTextureMenus();\r\n      $(\"texture-context-container\").show();\r\n      $(\"#wallTextures\").show();\r\n    }\r\n\r\n    function floorClicked(room) {\r\n      if (currentTarget) {\r\n        currentTarget.removeOutline();\r\n      }\r\n      currentTarget = room;\r\n      currentTarget.drawOutline();\r\n\r\n      // Mostrar el menú de texturas de piso\r\n      hideAllTextureMenus();\r\n      $(\"texture-context-container\").show();\r\n      $(\"#floorTexturesDiv\").show();\r\n    }\r\n\r\n    function reset() {\r\n      if (currentTarget) {\r\n        currentTarget.removeOutline();\r\n      }\r\n      currentTarget = null;\r\n\r\n      // Ocultar los menús de textura\r\n      hideAllTextureMenus();\r\n    }\r\n\r\n    init();\r\n  }\r\n\r\n  handleLogoutShow(e) {\r\n    e.preventDefault();\r\n    this.props.store.cambiarModuloLogout(true);\r\n  }\r\n\r\n  handleModalRepeat(e) {\r\n    e.preventDefault();\r\n    this.props.store.cambiarModuloRepetir(true);\r\n  }\r\n\r\n  handleModalInfo(e) {\r\n    e.preventDefault();\r\n    this.props.store.cambiarModuloInformacion(true);\r\n  }\r\n\r\n  async engine(viewKey) {\r\n    /*\r\n     * Floorplanner controls\r\n     */\r\n\r\n    var ViewerFloorplanner = function (blueprint3d) {\r\n      var canvasWrapper = \"#floorplanner\";\r\n\r\n      var move = \"#move\";\r\n      var remove = \"#delete\";\r\n      var draw = \"#draw\";\r\n\r\n      var activeStlye = \"btn-primary disabled\";\r\n\r\n      this.floorplanner = blueprint3d.floorplanner;\r\n\r\n      var scope = this;\r\n\r\n      function init() {\r\n        $(window).resize(scope.handleWindowResize);\r\n        scope.handleWindowResize();\r\n\r\n        scope.floorplanner.modeResetCallbacks.add(function (mode) {\r\n          $(draw).removeClass(activeStlye);\r\n          $(remove).removeClass(activeStlye);\r\n          $(move).removeClass(activeStlye);\r\n          if (mode === BP3D.Floorplanner.floorplannerModes.MOVE) {\r\n            $(move).addClass(activeStlye);\r\n          } else if (mode === BP3D.Floorplanner.floorplannerModes.DRAW) {\r\n            $(draw).addClass(activeStlye);\r\n          } else if (mode === BP3D.Floorplanner.floorplannerModes.DELETE) {\r\n            $(remove).addClass(activeStlye);\r\n          }\r\n\r\n          if (mode === BP3D.Floorplanner.floorplannerModes.DRAW) {\r\n            $(\"#draw-walls-hint\").show();\r\n            scope.handleWindowResize();\r\n          } else {\r\n            $(\"#draw-walls-hint\").hide();\r\n          }\r\n        });\r\n\r\n        $(move).click(function () {\r\n          scope.floorplanner.setMode(BP3D.Floorplanner.floorplannerModes.MOVE);\r\n        });\r\n        $(move).on(\"touchend\", function () {\r\n          scope.floorplanner.setMode(BP3D.Floorplanner.floorplannerModes.MOVE);\r\n        });\r\n\r\n        $(draw).click(function () {\r\n          scope.floorplanner.setMode(BP3D.Floorplanner.floorplannerModes.DRAW);\r\n        });\r\n        $(draw).on(\"touchend\", function () {\r\n          scope.floorplanner.setMode(BP3D.Floorplanner.floorplannerModes.DRAW);\r\n        });\r\n\r\n        $(remove).click(function () {\r\n          scope.floorplanner.setMode(\r\n            BP3D.Floorplanner.floorplannerModes.DELETE\r\n          );\r\n        });\r\n        $(remove).on(\"touchend\", function () {\r\n          scope.floorplanner.setMode(\r\n            BP3D.Floorplanner.floorplannerModes.DELETE\r\n          );\r\n        });\r\n      }\r\n\r\n      this.updateFloorplanView = function () {\r\n        scope.floorplanner.reset();\r\n      };\r\n\r\n      this.handleWindowResize = function () {\r\n        $(canvasWrapper).height(\r\n          window.innerHeight - $(canvasWrapper).offset().top\r\n        );\r\n        scope.floorplanner.resizeView();\r\n      };\r\n\r\n      init();\r\n    };\r\n\r\n    var mainControls = function (blueprint3d) {\r\n      function newDesign() {\r\n        blueprint3d.model.loadSerialized(NEW_STRUCTURE);\r\n      }\r\n\r\n      var loadDesign = async (event) => {\r\n        let name = $(\"#loadFile\").attr(\"name\");\r\n        let file1 = await axios.get(\"http:localhost:8001/assets/\" + name);\r\n        var reader = new FileReader();\r\n        reader.onload = function () {\r\n          var data = reader.result;\r\n          blueprint3d.model.loadSerialized(data);\r\n        };\r\n        reader.readAsText(file1);\r\n        $(\"#loadFile\").replaceWith($(\"#loadFile\").val(\"\").clone(true));\r\n\r\n        try {\r\n          let uri = $(\"#loadFile\").attr(\"uri\");\r\n          console.log(\"uri: \" + uri);\r\n          if (uri !== \"\") {\r\n            let res = await axios.get(\"http:localhost:8001/assets/\" + uri);\r\n            blueprint3d.model.loadSerialized(JSON.stringify(res.data));\r\n          }\r\n        } catch (e) {\r\n          console.log(e);\r\n        }\r\n      };\r\n\r\n      function saveDesign() {\r\n        var data = blueprint3d.model.exportSerialized();\r\n        var a = window.document.createElement(\"a\");\r\n        var blob = new Blob([data], {\r\n          type: \"text\",\r\n        });\r\n        a.href = window.URL.createObjectURL(blob);\r\n        a.download = \"design\";\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        document.body.removeChild(a);\r\n      }\r\n\r\n      function init() {\r\n        $(\"#new\").click(newDesign);\r\n        $(\"#new\").on(\"touchend\", newDesign);\r\n\r\n        $(\"#loadFile\").click(loadDesign);\r\n        $(\"#loadFileLabel\").on(\"touchend\", function () {\r\n          $(\"#loadFile\").trigger(\"click\");\r\n        });\r\n\r\n        $(\"#saveFile\").click(saveDesign);\r\n        $(\"#saveFile\").on(\"touchend\", saveDesign);\r\n      }\r\n\r\n      init();\r\n    };\r\n\r\n    /*\r\n     * Initialize!\r\n     */\r\n\r\n    var modalEffects = this.modalEffects(this.state.blueprint3d);\r\n    var viewerFloorplanner = new ViewerFloorplanner(this.state.blueprint3d);\r\n\r\n    var contextMenu = this.contextMenu(this.state.blueprint3d);\r\n    var sideMenu = this.sideMenu(\r\n      this.state.blueprint3d,\r\n      viewerFloorplanner,\r\n      modalEffects\r\n    );\r\n\r\n    // Verificar si sideMenu se inicializó correctamente\r\n    if (sideMenu) {\r\n      sideMenu.stateChangeCallbacks = $.Callbacks();\r\n    } else {\r\n      console.error(\"sideMenu no se pudo inicializar correctamente\");\r\n      return; // Detener ejecución si `sideMenu` es `undefined`\r\n    }\r\n\r\n    var textureSelector = this.textureSelector(\r\n      this.state.blueprint3d,\r\n      sideMenu\r\n    );\r\n\r\n    var cameraButtons = this.cameraButtons(this.state.blueprint3d);\r\n    mainControls(this.state.blueprint3d);\r\n\r\n    if (viewKey === \"\") {\r\n      this.state.blueprint3d.model.loadSerialized(INIT_STRUCTURE);\r\n    } else {\r\n      try {\r\n        let res = await axios.get(BASE_URL + ASSETS + viewKey);\r\n        let file1 = new Blob(res);\r\n        var blueprint3d = this.state.blueprint3d;\r\n        var reader = new FileReader();\r\n        reader.onload = function () {\r\n          var data = reader.result;\r\n          blueprint3d.model.loadSerialized(data);\r\n        };\r\n        reader.readAsText(file1);\r\n        this.state.blueprint3d.model.loadSerialized(JSON.stringify(res.data));\r\n      } catch (e) {\r\n        console.log(e);\r\n        this.state.blueprint3d.model.loadSerialized(INIT_STRUCTURE);\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    const { store } = this.props;\r\n    var opts = {\r\n      floorplannerElement: \"floorplanner-canvas\",\r\n      threeElement: \"#viewer\",\r\n      threeCanvasElement: \"three-canvas\",\r\n      textureDir: \"rooms/textures/\",\r\n      widget: false,\r\n    };\r\n    this.setState({ blueprint3d: new BP3D.Blueprint3d(opts) }, () => {\r\n      if (\r\n        this.props.viewKey !== undefined &&\r\n        this.props.viewKey !== null &&\r\n        this.props.viewKey !== \"\"\r\n      ) {\r\n        this.engine(this.props.viewKey);\r\n      } else {\r\n        this.engine(\"\");\r\n      }\r\n    });\r\n  }\r\n\r\n  setDesignState(newState, firstTime) {\r\n    firstTime = firstTime || false;\r\n    var ACTIVE_CLASS = \"active\";\r\n\r\n    $(\"#items_tab\").removeClass(ACTIVE_CLASS);\r\n    $(\"#design_tab\").addClass(ACTIVE_CLASS);\r\n\r\n    $(\"#add-items\").hide();\r\n    $(\"#viewer\").show();\r\n\r\n    this.state.blueprint3d.three.updateWindowSize();\r\n\r\n    function handleWindowResize() {\r\n      $(\".sidebar\").height(window.innerHeight);\r\n      $(\"#add-items\").height(window.innerHeight);\r\n    }\r\n    handleWindowResize();\r\n\r\n    function reset() {\r\n      $(\"texture-context-container\").hide();\r\n      $(\"#wallTextures\").hide();\r\n      $(\"#floorTexturesDiv\").hide();\r\n    }\r\n\r\n    reset();\r\n    this.setState({ currentStateName: \"Design\" });\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState, snapShot) {\r\n    if (this.props.añadirManejadorDeClick) {\r\n      this.setState({ añadirManejadorDeClick: true });\r\n      this.props.store.cambiarManejadorDeClick(false);\r\n      this.initItems(this.state.blueprint3d, this.setDesignState);\r\n    }\r\n    if (\r\n      this.props.añadirManejadorDeClick === false &&\r\n      prevProps.añadirManejadorDeClick\r\n    ) {\r\n      this.setState({ añadirManejadorDeClick: false });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { store } = this.props;\r\n    return (\r\n      <div className=\"horizontal-container\">\r\n        {/* Left Column */}\r\n\r\n        <div id=\"texture-context-container\">\r\n          {/* Context Menu */}\r\n          <div id=\"context-menu\">\r\n            <ContextMenu />\r\n          </div>\r\n          {/* Floor Textures */}\r\n          <div id=\"floorTexturesDiv\" style={{ display: \"none\" }}>\r\n            <FloorTextureList\r\n              usuarioHaIniciadoSesion={store.obtenerInicioDeSesion}\r\n            />\r\n          </div>\r\n\r\n          {/* Wall Textures */}\r\n          <div id=\"wallTextures\" style={{ display: \"none\" }}>\r\n            <WallTextureList\r\n              usuarioHaIniciadoSesion={store.obtenerInicioDeSesion}\r\n            />\r\n          </div>\r\n        </div>\r\n        {/* End Left Column */}\r\n\r\n        {/* Right Column */}\r\n        <div className=\"right-container\">\r\n          {/* 3D Viewer */}\r\n          <div id=\"viewer\">\r\n            {/* <div id=\"camera-controls\">\r\n              <Button\r\n                variant=\"info\"\r\n                size=\"sm\"\r\n                id=\"zoom-out\"\r\n                className={\"basic-button\"}\r\n              >\r\n                <FaSearchMinus />\r\n              </Button>\r\n              <Button\r\n                variant=\"info\"\r\n                size=\"sm\"\r\n                id=\"reset-view\"\r\n                className={\"basic-button\"}\r\n              >\r\n                <FaHome />\r\n              </Button>\r\n              <Button\r\n                variant=\"info\"\r\n                size=\"sm\"\r\n                id=\"zoom-in\"\r\n                className={\"basic-button\"}\r\n              >\r\n                <FaSearchPlus />\r\n              </Button>\r\n\r\n              <Button\r\n                variant=\"info\"\r\n                size=\"sm\"\r\n                id=\"move-left\"\r\n                className={\"basic-button\"}\r\n              >\r\n                <FaArrowLeft />\r\n              </Button>\r\n              <div className={\"vertical-controls-container\"}>\r\n                <Button\r\n                  variant=\"info\"\r\n                  size=\"sm\"\r\n                  id=\"move-up\"\r\n                  className={\"basic-button\"}\r\n                >\r\n                  <FaArrowUp />\r\n                </Button>\r\n                <Button\r\n                  variant=\"info\"\r\n                  size=\"sm\"\r\n                  id=\"move-down\"\r\n                  className={\"basic-button\"}\r\n                >\r\n                  <FaArrowDown />\r\n                </Button>\r\n              </div>\r\n              <Button\r\n                variant=\"info\"\r\n                size=\"sm\"\r\n                id=\"move-right\"\r\n                className={\"basic-button\"}\r\n              >\r\n                <FaArrowRight />\r\n              </Button>\r\n            </div> */}\r\n\r\n            <div id=\"loading-modal\">\r\n              <h1>Loading...</h1>\r\n            </div>\r\n          </div>\r\n\r\n          {/*2D Floorplanner */}\r\n          <div id=\"floorplanner\">\r\n            <canvas id=\"floorplanner-canvas\"></canvas>\r\n            <div id=\"floorplanner-controls\">\r\n              {/* <Button\r\n                variant=\"secondary\"\r\n                size=\"sm\"\r\n                className=\"icon-text-button\"\r\n                id=\"move\"\r\n              >\r\n                <span className=\"icon-centre\">\r\n                  <FaArrowsAlt />\r\n                </span>\r\n                <span className=\"text-centre\">Move Walls</span>\r\n              </Button>\r\n              <Button\r\n                variant=\"secondary\"\r\n                size=\"sm\"\r\n                className=\"icon-text-button\"\r\n                id=\"draw\"\r\n              >\r\n                <span className=\"icon-centre\">\r\n                  <FaPencilAlt />\r\n                </span>\r\n                <span className=\"text-centre\">Draw Walls</span>\r\n              </Button>\r\n              <Button\r\n                variant=\"secondary\"\r\n                size=\"sm\"\r\n                className=\"icon-text-button\"\r\n                id=\"delete\"\r\n              >\r\n                <span className=\"icon-centre\">\r\n                  <FaTrashAlt />\r\n                </span>\r\n                <span className=\"text-centre\">Delete Walls</span>\r\n              </Button> */}\r\n\r\n              <Button\r\n                variant=\"info\"\r\n                size=\"sm\"\r\n                className=\"icon-text-button\"\r\n                id=\"update-floorplan\"\r\n              >\r\n                <span className=\"text-centre\">Listo</span>\r\n                <span className=\"icon-centre\">\r\n                  <FaChevronRight />\r\n                </span>\r\n              </Button>\r\n            </div>\r\n            <div id=\"draw-walls-hint\">\r\n              Press the \"Esc\" key to stop drawing walls\r\n            </div>\r\n          </div>\r\n          {/* Add Items */}\r\n          <div id=\"add-items\">\r\n            <Tabs\r\n              variant=\"pills\"\r\n              style={{\r\n                display: \"flex\",\r\n                flexDirection: \"column\",\r\n                width: \"100px\",\r\n                position: \"absolute\",\r\n                right: \"100px\",\r\n                top: \"100px\",\r\n              }}\r\n              id=\"controlled-tab-example\"\r\n              activeKey={this.state.key}\r\n              onSelect={(k) => {\r\n                this.setState({ key: k });\r\n              }}\r\n            >\r\n              {/* <Tab eventKey=\"sofa\" title=\"Sofas\">\r\n                <CardListSofa usuarioHaIniciadoSesion={store.obtenerInicioDeSesion} />\r\n              </Tab> */}\r\n              <Tab eventKey=\"chair\" title=\"Sillas\">\r\n                <CardListChair\r\n                  usuarioHaIniciadoSesion={store.obtenerInicioDeSesion}\r\n                />\r\n              </Tab>\r\n              <Tab eventKey=\"rug\" title=\"Alfombras\">\r\n                <CardListRug\r\n                  usuarioHaIniciadoSesion={store.obtenerInicioDeSesion}\r\n                />\r\n              </Tab>\r\n              <Tab eventKey=\"misc\" title=\"Oficina personal y corporativa\">\r\n                <CardListMisc\r\n                  usuarioHaIniciadoSesion={store.obtenerInicioDeSesion}\r\n                />\r\n              </Tab>\r\n              <Tab eventKey=\"light\" title=\"Luces\">\r\n                <CardListLight\r\n                  usuarioHaIniciadoSesion={store.obtenerInicioDeSesion}\r\n                />\r\n              </Tab>\r\n              {/* <Tab eventKey=\"kitchen\" title=\"Kitchen\">\r\n                <CardListKitchen usuarioHaIniciadoSesion={store.obtenerInicioDeSesion} />\r\n              </Tab>\r\n              <Tab eventKey=\"arch\" title=\"Architectural\">\r\n                <CardListArch usuarioHaIniciadoSesion={store.obtenerInicioDeSesion} />\r\n              </Tab> */}\r\n            </Tabs>\r\n          </div>\r\n          <div className=\"menu\">\r\n            <div display=\"flex\">\r\n              <ul className=\"nav nav-sidebar\">\r\n                <li id=\"design_tab\">\r\n                  <OverlayTrigger\r\n                    placement=\"right\"\r\n                    overlay={<Tooltip>Diseñar</Tooltip>}\r\n                  >\r\n                    <div className=\"icons\">\r\n                      <div className=\"iconWrapper\">\r\n                        <FaCube size=\"25px\" />\r\n                      </div>\r\n                    </div>\r\n                  </OverlayTrigger>\r\n                </li>\r\n                <li id=\"floorplan_tab\">\r\n                  <OverlayTrigger\r\n                    placement=\"right\"\r\n                    overlay={<Tooltip>Editar piso</Tooltip>}\r\n                  >\r\n                    <div className=\"icons\">\r\n                      <div className=\"iconWrapper\">\r\n                        <FaPenFancy size=\"25px\" />\r\n                      </div>\r\n                    </div>\r\n                  </OverlayTrigger>\r\n                </li>\r\n                <li id=\"items_tab\">\r\n                  <OverlayTrigger\r\n                    placement=\"right\"\r\n                    overlay={<Tooltip>Añadir objeto</Tooltip>}\r\n                  >\r\n                    <div className=\"icons\">\r\n                      <div className=\"iconWrapper\">\r\n                        <FaPlus size=\"25px\" />\r\n                      </div>\r\n                    </div>\r\n                  </OverlayTrigger>\r\n                </li>\r\n                <li id=\"items_tab\">\r\n                  <img\r\n                    src=\"./logo.png\"\r\n                    className=\"top-bar-logo\"\r\n                    alt=\"\"\r\n                    style={{\r\n                      width: \"100px\",\r\n                      height: \"100px\",\r\n                      margin: \"-5px 10px 0 10px\",\r\n                    }}\r\n                  />\r\n                </li>\r\n                <li style={{ display: \"none\" }}>\r\n                  <OverlayTrigger\r\n                    placement=\"right\"\r\n                    overlay={<Tooltip>Repetir plano</Tooltip>}\r\n                  >\r\n                    <Button\r\n                      className=\"repeatButton\"\r\n                      onClick={this.handleModalRepeat}\r\n                    >\r\n                      <div className=\"icons\" id=\"new\">\r\n                        <div\r\n                          className=\"iconWrapper\"\r\n                          style={{ margin: 0, padding: 0 }}\r\n                        >\r\n                          <FaRedo size=\"25px\" />\r\n                        </div>\r\n                      </div>\r\n                    </Button>\r\n                  </OverlayTrigger>\r\n                </li>\r\n                <li>\r\n                  <OverlayTrigger\r\n                    placement=\"right\"\r\n                    overlay={<Tooltip>Repetir plano</Tooltip>}\r\n                  >\r\n                    <Button\r\n                      className=\"repeatButton\"\r\n                      onClick={this.handleModalRepeat}\r\n                    >\r\n                      <div className=\"icons\" id=\"new\">\r\n                        <div\r\n                          className=\"iconWrapper\"\r\n                          style={{ margin: 0, padding: 0 }}\r\n                        >\r\n                          <FaRedo size=\"25px\" />\r\n                        </div>\r\n                      </div>\r\n                    </Button>\r\n                  </OverlayTrigger>\r\n                </li>\r\n                <li id=\"design_tab\">\r\n                  <ScreenCaptureButton />\r\n                </li>\r\n                <li>\r\n                  <OverlayTrigger\r\n                    placement=\"right\"\r\n                    overlay={<Tooltip>Información</Tooltip>}\r\n                  >\r\n                    <Button\r\n                      className=\"repeatButton\"\r\n                      onClick={this.handleModalInfo}\r\n                    >\r\n                      <div className=\"icons\" id=\"new\">\r\n                        <div\r\n                          className=\"iconWrapper\"\r\n                          style={{ margin: 0, padding: 0 }}\r\n                        >\r\n                          <FaInfoCircle size=\"25px\" />\r\n                        </div>\r\n                      </div>\r\n                    </Button>\r\n                  </OverlayTrigger>\r\n                </li>\r\n                <li>\r\n                  <Button\r\n                    variant=\"outline-dark\"\r\n                    className=\"top-bar-login-button\"\r\n                    style={{ position: \"absolute\", top: \"10px\", right: 0 }}\r\n                    onClick={this.handleLogoutShow}\r\n                  >\r\n                    Salir\r\n                  </Button>\r\n                </li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        {/* End Right Column */}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default AppContenido;\r\n"]},"metadata":{},"sourceType":"module"}